<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Report</title>
</head>
<body>
    <div id='login'>
        <form onsubmit='return login(event)'>
            <label for='email'>email</label>
            <input type='text' id='email'>
            <label for='password'>password</label>
            <input type='password' id='password'>
            <input type='submit' value='Login'>
        </form>
    </div>
    <div id='course'>Courses</div>
    <div id='attendance'>Attendance</div>
    <div id='grades'>Grades</div>
</body>
</html>
<!-- <script src="https://d3js.org/d3.v5.min.js"></script>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script> -->
<script>
    var token = '';
    var grades = '';

    function getAttendance() {

    }

    function getGrades(courseId) {
        const url = 'https://bootcampspot.com/api/instructor/v1/grades';
        var request = new XMLHttpRequest();
        request.open("POST", url, false);
        request.setRequestHeader('Content-Type','application/json');
        request.setRequestHeader('authToken',token);
        request.send(JSON.stringify({courseId:courseId}));
        grades = request.responseText;
    }

    function update(courseId) {
        document.getElementById('attendance').innerHTML = 'Attendance';
        getAttendance(courseId);
        document.getElementById('grades').innerHTML = 'Grades';
        getGrades(courseId);
    }

    function insertCourses(row) {
        document.getElementById('course').innerHTML += `<p>${row['courseId']}</p>`
    }

    function getCourses() {
        const url = 'https://bootcampspot.com/api/instructor/v1/me';
        var request = new XMLHttpRequest();
        request.open("GET", url, false);
        request.setRequestHeader('Content-Type','application/json');
        request.setRequestHeader('authToken',token);
        request.send();
        JSON.parse(request.responseText).enrollments.forEach(insertCourses);
    }

    function login(event) {
        const url = 'https://bootcampspot.com/api/instructor/v1/login';
        var request = new XMLHttpRequest();
        request.open("POST", url, false);
        request.setRequestHeader('Content-Type','application/json');
        request.send(JSON.stringify({
                email:document.getElementById('email').value,
                password:document.getElementById('password').value
            }));
        token = JSON.parse(request.responseText).authenticationInfo.authToken;
        getCourses();
        return false; //prevents page reload
    }
</script>